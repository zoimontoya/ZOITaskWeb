
@if (isAddingTask) {
    <app-newTask (cancel)="onCancelAddTask()" (add)="onAddTask($event)"/>
}
@if (editingTask) {
    <app-newTask [task]="editingTask" (cancel)="onCancelEditTask()" (add)="onEditTask($event)"/>
}

<section id="tasks">
    <header>
        <h2>Tareas de {{name}}</h2>
        <menu *ngIf="!isEncargado">
            <button (click)="onStartAddTask()">Añadir tarea</button>
        </menu>
    </header>

    <ul>
        @if (loading) {
            <li><span style="color: #aaa;">Cargando tareas...</span></li>
        } @else if (tasks.length === 0) {
            <li><span style="color: #aaa;">No hay tareas para este usuario.</span></li>
        } @else {
            @for (task of tasks; track task.descripcion) {
                <li class="task-card">
                    <div class="task-card-content">
                        <div class="task-card-header">
                            <strong>{{task.tipo_tarea}}</strong>
                        </div>
                        <div class="task-card-desc">{{task.descripcion}}</div>
                        <div class="task-card-meta">
                            <span>Invernadero: <b>{{task.invernadero}}</b></span>
                            <span>Estimación: <b>{{task.estimacion_horas}}h</b></span>
                            <span>Fecha límite: <b>{{task.fecha_limite}}</b></span>
                        </div>
                        <button *ngIf="!isEncargado" class="edit-btn" (click)="onStartEditTask(task)">Editar</button>
                    </div>
                </li>
            }
        }
    </ul>
</section>

